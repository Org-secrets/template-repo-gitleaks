#!/bin/sh

echo "ğŸ” Verificando segredos com GitLeaks antes do push..."

# Remover relatÃ³rio antigo, se existir
if [ -f gitleaks-report.json ]; then
    rm gitleaks-report.json
fi

# Executar o GitLeaks e gerar o relatÃ³rio corretamente no Windows
gitleaks detect --source . --report-path ./gitleaks-report.json --no-color

# Verificar o resultado do GitLeaks
if [ $? -ne 0 ]; then
    echo "â— GitLeaks encontrou segredos. Push abortado."
    echo "ğŸ’¾ RelatÃ³rio gerado em: ./gitleaks-report.json"
    exit 1
fi

echo "âœ… Nenhum segredo encontrado. Push permitido."
exit 0
